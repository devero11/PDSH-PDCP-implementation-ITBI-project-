#config bridge

sudo ip link add name br0 type bridge
sudo ip addr add 192.168.100.1/24 dev br0
sudo ip link set br0 up#config tap

#config tap

sudo ip tuntap add dev tap0 mode tap user $(whoami)
sudo ip link set tap0 master br0
sudo ip link set dev tap0 up


#qemu start

qemu-system-x86_64 \
  -enable-kvm \
  -m 1024 \
  -cpu host \
  -smp 2 \
  -drive file=./foo2.qcow2,format=qcow2 \
  -nographic \
-netdev tap,id=net0,ifname=tap1,script=no,downscript=no \
-device e1000,netdev=net0



dhcp server??



#!/bin/bash

echo Creating Bridge Network

ip link add name testBridge type bridge
ip addr add 192.168.100.1/24 dev testBridge
ip link set testBridge up


echo Creating Taps 

i=1
for entry in ./VMs/foo*; do
  
  ip tuntap add dev tap$i mode tap user $(whoami)
  ip link set tap$i master testBridge 
  ip link set dev tap$i up
 
  ((i++))

done


echo Launching VMs

i=1
for entry in ./VMs/foo*; do
  idx=$i
  ((i++))
  echo $idx 

  qemu-system-x86_64 \
  -enable-kvm \
  -m 512 \
  -cpu host \
  -smp 2 \
  -drive file=./VMs/foo$idx.qcow2,format=qcow2 \
  -nographic \
  -netdev tap,id=net$idx,ifname=tap$idx,script=no,downscript=no \
  -device e1000,netdev=net$idx,mac=52:54:00:00:00:$idx \
  &


d





sudo firewall-cmd --add-service=dhcp --permanent
sudo firewall-cmd --reload
